/* {
"admin_level": "7",
"area:land:km2": "142.2",
"area:land:km2:source": "Statistiska centralbyr책n",
"boundary": "administrative",
"name": "H책bo kommun",
"population": "16874",
"population:source": "Statistiska centralbyr책n",
"population:source:date": "1996",
"ref:se:kommun:kod": "0305",
"ref:se:kommun:kod:1977-1979": "0305",
"ref:se:kommun:kod:1980-1982": "0305",
"ref:se:kommun:kod:1983-1991": "0305",
"ref:se:kommun:kod:1992-1994": "0305",
"ref:se:kommun:kod:1995-1996": "0305",
"ref:se:kommun:kod:1997": "0305",
"ref:se:kommun:kod:1998": "0305",
"short_name": "H책bo",
"type": "multipolygon",
"smahus": 5766,
"flerbostadshus": 2120,
"ovriga hus": 67,
"specialbostader": 56,
"rape": 4,
"enskildForskolaArbetare": 29,
"enskildForskolaArbetarePerBarn": 5.6,
"kommunForskolaArbetare": 148,
"kommunForskolaArbetarePerBarn": 5.9,
"disponibelInkomst": 256.76,
"fysiskvaldkvinnor": 0,
"fysiskvaldman": 0,
"psyk_psykosomatiska": "7.68",
"psyk_nedstamdhet": "8.89",
"psyk_koncentration": "9.44",
"suicidewomen": "0.0",
"suicidemen": "1.0",
"suicidetotal": "0.5",
"utb_pre_gymnasium_women": "883",
"utb_pre_gymnasium_men": "1183",
"utb_pre_gymnasium_total": "3206",
"utb_gymnasium_women": "3409",
"utb_gymnasium_men": "2131",
"utb_gymnasium_total": "1629",
"utb_post_gymnasium_women": "52",
"utb_post_gymnasium_men": "110",
"utb_post_gymnasium_total": 0,
"income_18_mid": 527.7,
"income_18_med": 466.2,
"income_1829_mid": 400.6,
"income_1829_med": 345.7,
"income_3049_mid": 602.3,
"income_3049_med": 569,
"income_5064_mid": 607.4,
"income_5064_med": 548.1,
"income_65_mid": 389,
"income_65_med": 303.4,
"income_6579_mid": 420.7,
"income_6579_med": 335.8,
"income_80_mid": 261.3,
"income_80_med": 180.9,
"crime": 66,
"tax_hyreshus_bostader": 559404,
"tax_hyreshus_bostader_lokaler": 1020051,
"tax_hotell_restaurang": 120955,
"hyreshusenhet_lokaler": 269005,
"tax_other": 17652,
"admin_level_diff": 0,
"population_diff": 13600.124137931034,
"smahus_diff": 1192.8413793103446,
"flerbostadshus_diff": 6116.451724137931,
"ovriga hus_diff": 205.17931034482757,
"specialbostader_diff": 740.5551724137931,
"rape_diff": 8.417241379310346,
"enskildForskolaArbetare_diff": 35.84482758620689,
"enskildForskolaArbetarePerBarn_diff": 1.3324137931034468,
"kommunForskolaArbetare_diff": 111.91724137931033,
"kommunForskolaArbetarePerBarn_diff": 0.5844827586206858,
"disponibelInkomst_diff": 32.04262068965511,
"fysiskvaldkvinnor_diff": 1.3103448275862069,
"fysiskvaldman_diff": 1.5793103448275863,
"psyk_psykosomatiska_diff": 2.748206896551725,
"psyk_nedstamdhet_diff": 4.020620689655173,
"psyk_koncentration_diff": 4.487896551724138,
"suicidewomen_diff": 0.804137931034483,
"suicidemen_diff": 1.4144827586206907,
"suicidetotal_diff": 1.1127586206896556,
"utb_pre_gymnasium_women_diff": 487.90344827586205,
"utb_pre_gymnasium_men_diff": 610.7931034482758,
"utb_pre_gymnasium_total_diff": 1147.2931034482763,
"utb_gymnasium_women_diff": 1534.568965517241,
"utb_gymnasium_men_diff": 2428.7896551724134,
"utb_gymnasium_total_diff": 2068.8,
"utb_post_gymnasium_women_diff": 89.81724137931033,
"utb_post_gymnasium_men_diff": 90.50689655172414,
"utb_post_gymnasium_total_diff": 0,
"income_18_mid_diff": 110.76275862069008,
"income_18_med_diff": 126.88344827586207,
"income_1829_mid_diff": 77.74551724137945,
"income_1829_med_diff": 70.8755172413791,
"income_3049_mid_diff": 111.31965517241349,
"income_3049_med_diff": 105.58413793103449,
"income_5064_mid_diff": 100.93275862068964,
"income_5064_med_diff": 105.13137931034453,
"income_65_mid_diff": 78.86068965517251,
"income_65_med_diff": 73.62620689655148,
"income_6579_mid_diff": 71.25448275862044,
"income_6579_med_diff": 63.430000000000234,
"income_80_mid_diff": 42.64206896551727,
"income_80_med_diff": 21.700344827586065,
"crime_diff": 20.248275862068965,
"tax_hyreshus_bostader_diff": 991078.7517241379,
"tax_hyreshus_bostader_lokaler_diff": 4469479.093103448,
"tax_hotell_restaurang_diff": 96496.36206896552,
"hyreshusenhet_lokaler_diff": 1646893.5862068965,
"tax_other_diff": 53668.396551724145,
"CELL_ID": 920,
"GRIDCODE": 58.893
}
*/




var METADATA = [
    {
        "key": "admin_level",
        "title": "admin_level",
        "min": 7,
        "max": 7,
        "count": 290,
        "mid": 7,
        "total": 2030,
        "p50": 7,
        "p75": 7,
        "p90": 7,
        "p95": 7,
        "p99": 7
    },
    {
        "key": "population",
        "title": "population",
        "min": 0,
        "max": 711119,
        "count": 290,
        "mid": 30474.124137931034,
        "total": 8837496,
        "p50": 15971,
        "p75": 31803,
        "p90": 60592,
        "p95": 90587,
        "p99": 245699
    },
    {
        "key": "lanid",
        "title": "lanid",
        "min": 10,
        "max": 25,
        "count": 290,
        "mid": null,
        "total": null,
        "p50": 14,
        "p75": 19,
        "p90": 24,
        "p95": 24,
        "p99": 25
    },
    {
        "key": "availJobs",
        "title": "availJobs",
        "min": 5,
        "max": 11499,
        "count": 290,
        "mid": null,
        "total": null,
        "p50": null,
        "p75": null,
        "p90": 682,
        "p95": 1181,
        "p99": 2049
    },
    {
        "key": "jobAds",
        "title": "jobAds",
        "min": 5,
        "max": 4290,
        "count": 290,
        "mid": null,
        "total": null,
        "p50": null,
        "p75": 66,
        "p90": 182,
        "p95": 345,
        "p99": 723
    },
    {
        "key": "smahus",
        "title": "smahus",
        "min": 506,
        "max": 52568,
        "count": 290,
        "mid": 6958.841379310345,
        "total": 2018064,
        "p50": 4664,
        "p75": 8367,
        "p90": 15262,
        "p95": 20386,
        "p99": 28025
    },
    {
        "key": "flerbostadshus",
        "title": "flerbostadshus",
        "min": 82,
        "max": 391624,
        "count": 290,
        "mid": 8236.45172413793,
        "total": 2388571,
        "p50": 2318,
        "p75": 6383,
        "p90": 17880,
        "p95": 28574,
        "p99": 121208
    },
    {
        "key": "ovriga hus",
        "title": "ovriga hus",
        "min": 4,
        "max": 9995,
        "count": 290,
        "mid": 272.17931034482757,
        "total": 78932,
        "p50": 129,
        "p75": 260,
        "p90": 579,
        "p95": 787,
        "p99": 3054
    },
    {
        "key": "specialbostader",
        "title": "specialbostader",
        "min": 7,
        "max": 22370,
        "count": 290,
        "mid": 796.5551724137931,
        "total": 231001,
        "p50": 259,
        "p75": 519,
        "p90": 1580,
        "p95": 2794,
        "p99": 14235
    },
    {
        "key": "disponibelInkomst",
        "title": "disponibelInkomst",
        "min": 185.85,
        "max": 375.6,
        "count": 290,
        "mid": 224.71737931034488,
        "total": 65168.040000000015,
        "p50": 219.01,
        "p75": 230.82,
        "p90": 256.22,
        "p95": 269.59,
        "p99": 315.36
    },
    {
        "key": "rape",
        "title": "rape",
        "min": 0,
        "max": 507,
        "count": 290,
        "mid": 12.417241379310346,
        "total": 3601,
        "p50": 5,
        "p75": 11,
        "p90": 23,
        "p95": 42,
        "p99": 136
    },
    {
        "key": "fysiskvaldkvinnor",
        "title": "fysiskvaldkvinnor",
        "min": 0,
        "max": 5,
        "count": 290,
        "mid": 1.3103448275862069,
        "total": 380,
        "p50": 1,
        "p75": 2,
        "p90": 3,
        "p95": 4,
        "p99": 5
    },
    {
        "key": "fysiskvaldman",
        "title": "fysiskvaldman",
        "min": 0,
        "max": 7,
        "count": 290,
        "mid": 1.5793103448275863,
        "total": 458,
        "p50": 1,
        "p75": 3,
        "p90": 4,
        "p95": 4,
        "p99": 6
    },
    {
        "key": "enskildForskolaArbetare",
        "title": "enskildForskolaArbetare",
        "min": 0,
        "max": 3547,
        "count": 290,
        "mid": 64.84482758620689,
        "total": 18805,
        "p50": 14,
        "p75": 47,
        "p90": 157,
        "p95": 235,
        "p99": 678
    },
    {
        "key": "enskildForskolaArbetarePerBarn",
        "title": "enskildForskolaArbetarePerBarn",
        "min": 0,
        "max": 8.6,
        "count": 290,
        "mid": 4.267586206896553,
        "total": 1237.6000000000004,
        "p50": 5,
        "p75": 5.5,
        "p90": 5.9,
        "p95": 6.2,
        "p99": 7.3
    },
    {
        "key": "kommunForskolaArbetare",
        "title": "kommunForskolaArbetare",
        "min": 16,
        "max": 6731,
        "count": 290,
        "mid": 259.9172413793103,
        "total": 75376,
        "p50": 114,
        "p75": 257,
        "p90": 579,
        "p95": 881,
        "p99": 3218
    },
    {
        "key": "kommunForskolaArbetarePerBarn",
        "title": "kommunForskolaArbetarePerBarn",
        "min": 3.8,
        "max": 7.5,
        "count": 290,
        "mid": 5.315517241379315,
        "total": 1541.5000000000011,
        "p50": 5.3,
        "p75": 5.6,
        "p90": 5.8,
        "p95": 6,
        "p99": 6.9
    },
    {
        "key": "psyk_psykosomatiska",
        "title": "psyk_psykosomatiska",
        "min": 0,
        "max": 9.96,
        "count": 290,
        "mid": 4.931793103448275,
        "total": 1430.2199999999996,
        "p50": 4.98,
        "p75": 7.47,
        "p90": 8.99,
        "p95": 9.48,
        "p99": 9.89
    },
    {
        "key": "psyk_nedstamdhet",
        "title": "psyk_nedstamdhet",
        "min": 0,
        "max": 9.96,
        "count": 290,
        "mid": 4.8693793103448275,
        "total": 1412.12,
        "p50": 4.91,
        "p75": 7.4,
        "p90": 8.96,
        "p95": 9.44,
        "p99": 9.86
    },
    {
        "key": "psyk_koncentration",
        "title": "psyk_koncentration",
        "min": 0,
        "max": 10,
        "count": 290,
        "mid": 4.952103448275862,
        "total": 1436.11,
        "p50": 4.98,
        "p75": 7.47,
        "p90": 8.99,
        "p95": 9.48,
        "p99": 9.89
    },
    {
        "key": "suicidewomen",
        "title": "suicidewomen",
        "min": 0,
        "max": 3.5,
        "count": 290,
        "mid": 0.804137931034483,
        "total": 233.20000000000005,
        "p50": 0.7,
        "p75": 1.1,
        "p90": 1.5,
        "p95": 1.7,
        "p99": 3.3
    },
    {
        "key": "suicidemen",
        "title": "suicidemen",
        "min": 0,
        "max": 7.2,
        "count": 290,
        "mid": 2.4144827586206907,
        "total": 700.2000000000003,
        "p50": 2.2,
        "p75": 3,
        "p90": 3.9,
        "p95": 4.9,
        "p99": 6.1
    },
    {
        "key": "suicidetotal",
        "title": "suicidetotal",
        "min": 0.2,
        "max": 4.2,
        "count": 290,
        "mid": 1.6127586206896556,
        "total": 467.7000000000001,
        "p50": 1.5,
        "p75": 1.9,
        "p90": 2.6,
        "p95": 2.9,
        "p99": 3.8
    },
    {
        "key": "utb_pre_gymnasium_women",
        "title": "utb_pre_gymnasium_women",
        "min": 71,
        "max": 27552,
        "count": 290,
        "mid": 1370.903448275862,
        "total": 397562,
        "p50": 718,
        "p75": 1450,
        "p90": 2548,
        "p95": 4625,
        "p99": 14326
    },
    {
        "key": "utb_pre_gymnasium_men",
        "title": "utb_pre_gymnasium_men",
        "min": 152,
        "max": 34228,
        "count": 290,
        "mid": 1793.7931034482758,
        "total": 520200,
        "p50": 1088,
        "p75": 1968,
        "p90": 3240,
        "p95": 5490,
        "p99": 14994
    },
    {
        "key": "utb_pre_gymnasium_total",
        "title": "utb_pre_gymnasium_total",
        "min": 356,
        "max": 90054,
        "count": 290,
        "mid": 4353.293103448276,
        "total": 1262455,
        "p50": 2325,
        "p75": 4630,
        "p90": 9079,
        "p95": 12677,
        "p99": 34488
    },
    {
        "key": "utb_gymnasium_women",
        "title": "utb_gymnasium_women",
        "min": 454,
        "max": 100110,
        "count": 290,
        "mid": 4943.568965517241,
        "total": 1433635,
        "p50": 2588,
        "p75": 5272,
        "p90": 9839,
        "p95": 15078,
        "p99": 39340
    },
    {
        "key": "utb_gymnasium_men",
        "title": "utb_gymnasium_men",
        "min": 188,
        "max": 182147,
        "count": 290,
        "mid": 4559.789655172413,
        "total": 1322339,
        "p50": 1696,
        "p75": 4261,
        "p90": 9872,
        "p95": 14177,
        "p99": 50337
    },
    {
        "key": "utb_gymnasium_total",
        "title": "utb_gymnasium_total",
        "min": 118,
        "max": 160556,
        "count": 290,
        "mid": 3697.8,
        "total": 1072362,
        "p50": 1120,
        "p75": 3153,
        "p90": 8556,
        "p95": 12227,
        "p99": 44119
    },
    {
        "key": "utb_post_gymnasium_women",
        "title": "utb_post_gymnasium_women",
        "min": 3,
        "max": 6418,
        "count": 290,
        "mid": 141.81724137931033,
        "total": 41127,
        "p50": 55,
        "p75": 105,
        "p90": 261,
        "p95": 439,
        "p99": 2892
    },
    {
        "key": "utb_post_gymnasium_men",
        "title": "utb_post_gymnasium_men",
        "min": 5,
        "max": 9138,
        "count": 290,
        "mid": 200.50689655172414,
        "total": 58147,
        "p50": 85,
        "p75": 150,
        "p90": 357,
        "p95": 532,
        "p99": 3685
    },
    {
        "key": "utb_post_gymnasium_total",
        "title": "utb_post_gymnasium_total",
        "min": 0,
        "max": 0,
        "count": 290,
        "mid": 0,
        "total": 0,
        "p50": 0,
        "p75": 0,
        "p90": 0,
        "p95": 0,
        "p99": 0
    },
    {
        "key": "income_18_mid",
        "title": "income_18_mid",
        "min": 314.5,
        "max": 1309.8,
        "count": 290,
        "mid": 416.93724137930997,
        "total": 120911.79999999989,
        "p50": 394.6,
        "p75": 435.2,
        "p90": 515,
        "p95": 581.2,
        "p99": 713
    },
    {
        "key": "income_18_med",
        "title": "income_18_med",
        "min": 259.8,
        "max": 652.2,
        "count": 290,
        "mid": 339.3165517241379,
        "total": 98401.8,
        "p50": 324.3,
        "p75": 350.3,
        "p90": 426.6,
        "p95": 488.3,
        "p99": 541.9
    },
    {
        "key": "income_1829_mid",
        "title": "income_1829_mid",
        "min": 221,
        "max": 543.9,
        "count": 290,
        "mid": 322.8544827586206,
        "total": 93627.79999999996,
        "p50": 313.2,
        "p75": 344.7,
        "p90": 385.8,
        "p95": 405.4,
        "p99": 458.9
    },
    {
        "key": "income_1829_med",
        "title": "income_1829_med",
        "min": 165.7,
        "max": 444.7,
        "count": 290,
        "mid": 274.8244827586209,
        "total": 79699.10000000006,
        "p50": 270,
        "p75": 295.7,
        "p90": 324.5,
        "p95": 348.6,
        "p99": 389.3
    },
    {
        "key": "income_3049_mid",
        "title": "income_3049_mid",
        "min": 371,
        "max": 1521.1,
        "count": 290,
        "mid": 490.98034482758646,
        "total": 142384.30000000008,
        "p50": 465.1,
        "p75": 504.6,
        "p90": 586.7,
        "p95": 663.8,
        "p99": 833.6
    },
    {
        "key": "income_3049_med",
        "title": "income_3049_med",
        "min": 330.2,
        "max": 919,
        "count": 290,
        "mid": 463.4158620689655,
        "total": 134390.6,
        "p50": 454.5,
        "p75": 481.6,
        "p90": 546.6,
        "p95": 609.1,
        "p99": 696
    },
    {
        "key": "income_5064_mid",
        "title": "income_5064_mid",
        "min": 371.1,
        "max": 1721.4,
        "count": 290,
        "mid": 506.46724137931034,
        "total": 146875.5,
        "p50": 480.1,
        "p75": 530.3,
        "p90": 615.8,
        "p95": 669.1,
        "p99": 868.7
    },
    {
        "key": "income_5064_med",
        "title": "income_5064_med",
        "min": 317.6,
        "max": 902.1,
        "count": 290,
        "mid": 442.9686206896555,
        "total": 128460.9000000001,
        "p50": 431.9,
        "p75": 464.8,
        "p90": 523.2,
        "p95": 578.3,
        "p99": 662.6
    },
    {
        "key": "income_65_mid",
        "title": "income_65_mid",
        "min": 227.2,
        "max": 963.7,
        "count": 290,
        "mid": 310.1393103448275,
        "total": 89940.39999999997,
        "p50": 291.8,
        "p75": 331,
        "p90": 395.7,
        "p95": 425.7,
        "p99": 534.4
    },
    {
        "key": "income_65_med",
        "title": "income_65_med",
        "min": 168,
        "max": 405.5,
        "count": 290,
        "mid": 229.7737931034485,
        "total": 66634.40000000007,
        "p50": 224.4,
        "p75": 242.5,
        "p90": 272.5,
        "p95": 298.7,
        "p99": 334.3
    },
    {
        "key": "income_6579_mid",
        "title": "income_6579_mid",
        "min": 254.7,
        "max": 1184.4,
        "count": 290,
        "mid": 349.44551724137955,
        "total": 101339.20000000007,
        "p50": 329.5,
        "p75": 377.2,
        "p90": 438.6,
        "p95": 479.6,
        "p99": 599.9
    },
    {
        "key": "income_6579_med",
        "title": "income_6579_med",
        "min": 195.6,
        "max": 514.2,
        "count": 290,
        "mid": 272.3699999999998,
        "total": 78987.29999999993,
        "p50": 265.3,
        "p75": 282.8,
        "p90": 315.1,
        "p95": 336.9,
        "p99": 394.7
    },
    {
        "key": "income_80_mid",
        "title": "income_80_mid",
        "min": 164.1,
        "max": 562.5,
        "count": 290,
        "mid": 218.65793103448274,
        "total": 63410.799999999996,
        "p50": 206.7,
        "p75": 228.6,
        "p90": 267.1,
        "p95": 295.1,
        "p99": 348.2
    },
    {
        "key": "income_80_med",
        "title": "income_80_med",
        "min": 139.7,
        "max": 271.2,
        "count": 290,
        "mid": 159.19965517241394,
        "total": 46167.900000000045,
        "p50": 155.1,
        "p75": 161.1,
        "p90": 175.8,
        "p95": 192,
        "p99": 231.8
    },
    {
        "key": "crime",
        "title": "crime",
        "min": 23,
        "max": 222,
        "count": 290,
        "mid": 86.24827586206897,
        "total": 25012,
        "p50": 82,
        "p75": 106,
        "p90": 126,
        "p95": 141,
        "p99": 168
    },
    {
        "key": "tax_hyreshus_bostader",
        "title": "tax_hyreshus_bostader",
        "min": 6201,
        "max": 77994220,
        "count": 290,
        "mid": 1550482.751724138,
        "total": 449639998,
        "p50": 324727,
        "p75": 1082616,
        "p90": 2834057,
        "p95": 5676521,
        "p99": 22438865
    },
    {
        "key": "tax_hyreshus_bostader_lokaler",
        "title": "tax_hyreshus_bostader_lokaler",
        "min": 8345,
        "max": 512906895,
        "count": 290,
        "mid": 5489530.093103448,
        "total": 1591963727,
        "p50": 553442,
        "p75": 2406025,
        "p90": 9707290,
        "p95": 14682134,
        "p99": 90948031
    },
    {
        "key": "tax_hotell_restaurang",
        "title": "tax_hotell_restaurang",
        "min": 0,
        "max": 1631574,
        "count": 290,
        "mid": 24458.637931034482,
        "total": 7093005,
        "p50": 2378,
        "p75": 12388,
        "p90": 46901,
        "p95": 100480,
        "p99": 270855
    },
    {
        "key": "hyreshusenhet_lokaler",
        "title": "hyreshusenhet_lokaler",
        "min": 4184,
        "max": 209774699,
        "count": 290,
        "mid": 1915898.5862068965,
        "total": 555610590,
        "p50": 162073,
        "p75": 577635,
        "p90": 2884991,
        "p95": 5425715,
        "p99": 27935950
    },
    {
        "key": "tax_other",
        "title": "tax_other",
        "min": 20,
        "max": 3908354,
        "count": 290,
        "mid": 71320.39655172414,
        "total": 20682915,
        "p50": 5774,
        "p75": 33610,
        "p90": 143264,
        "p95": 238150,
        "p99": 1720423
    }
];


module.exports = function(input) {
    var grouped = {
        sorted: []
    };

    delete(input.geometry)
    delete(input.admin_level)
    delete(input.lanid)

    METADATA.forEach(function(md) {
        // console.log('md', md)
        if (input[md.key]) {
            var v = input[md.key]
            var fieldinfo = {
                key: md.key,
                name: md.title,
                value: v,
            };
            console.log("MD",md);
            fieldinfo.diff = v - md.mid
            //fieldinfo.diffpct = ((v - md.mid) - md.min) / (md.max - md.min)
            fieldinfo.diffpct = fieldinfo.diff/md.mid;
            fieldinfo.absdiffpct = Math.abs(fieldinfo.diffpct)
            fieldinfo.min = md.min
            fieldinfo.avg = md.mid
            fieldinfo.max = md.max
            fieldinfo.p95 = md.p95
            fieldinfo.p50 = md.p50
            grouped.sorted.push(fieldinfo)
        }
    })

    grouped.sorted.sort(function(a, b) {
        return b.absdiffpct - a.absdiffpct;
    })

    // grouped.x = input;

    return grouped;
}
